# Neural Network Lightmap

My old articles from the Pre-3DGS Era [Neural Network Lightmap | 神经网络光照贴图](https://ma-yidong.com/2023/02/26/neural-network-lightmap/)

Online demo: [nn-lightmap](https://nnlm.ma-yidong.com/)

![](https://ma-yidong.com/images/Untitled_2.jpg)


## Synthetic Data
![](https://ma-yidong.com/images/Untitled_7.jpg)


## Lightmap Result  
![](https://ma-yidong.com/images/Untitled_11.jpg)

## Sample Shader
```glsl
uniform sampler2D lm0;
uniform sampler2D lm1;
varying vec3 vWorldPosition;
varying vec2 vUv;
void main() {
    vec4 f00 = texture2D(lm0, vUv).rgba * 2.0 - 1.0;
    vec4 f01 = texture2D(lm1, vUv).rgba * 2.0 - 1.0;
    vec3 dir = -normalize( vWorldPosition - cameraPosition);
    // remap to blender
    dir = vec3(-dir.x, dir.z, -dir.y);
    vec4 f02 = vec4(.282,-.489*dir.y,.489*dir.z,-.489*dir.x);
    vec3 xxyyzz=dir*dir;
    vec3 xyyzxz=dir.xyx*dir.yzz;
    vec4 f03=vec4(1.093*xyyzxz.x,-1.093*xyyzxz.y,.31539156525252005*(2.f*xxyyzz.z-xxyyzz.x-xxyyzz.y),-1.093*xyyzxz.z);
    vec4 f04=vec4(.546*(xxyyzz.x-xxyyzz.y),-.59*dir.y*(3.f*xxyyzz.x-xxyyzz.y),2.891*xyyzxz.x*dir.z,-.457*dir.y*(4.f*xxyyzz.z-xxyyzz.x-xxyyzz.y));
    vec4 f05=vec4(.373*dir.z*(2.f*xxyyzz.z-3.f*xxyyzz.x-3.f*xxyyzz.y), -.457*dir.x*(4.f*xxyyzz.z-xxyyzz.x-xxyyzz.y), 1.445*dir.z*(xxyyzz.x-xxyyzz.y), -.59*dir.x*(xxyyzz.x-3.f*xxyyzz.y));
    vec4 f10=sin(mat4(.239,.153,-.331,-.634,-.537,-.129,.086,-.629,.179,-.3,.186,-.264,-.017,-.229,-.29,-.259)*f00+mat4(-.226,-.321,-.381,-.029,-.219,-.277,-.211,.349,.264,.368,-.238,.193,.547,.443,.016,-.304)*f01+mat4(-.483,.143,.362,-.269,.65,-.117,-.487,-.38,-.537,.196,.663,.191,-.139,.394,-.404,.074)*f02+mat4(.071,.032,-.26,-.313,-.485,-.429,.037,-.153,.588,-.262,-.091,-.62,.07,-.118,.039,-.091)*f03+mat4(.018,.095,-.432,.216,.355,-.108,-.09,.178,-.139,.041,-.033,-.364,-.141,.186,-.145,.167)*f04+mat4(.271,.102,.018,-.023,-.31,-.059,.247,.073,-.379,.149,-.103,-.153,.129,.174,-.083,-.138)*f05+vec4(-.202,.081,-.071,-.391));
    vec4 f11=sin(mat4(.184,.453,.253,.123,.566,-.274,.682,-.117,.534,.169,.364,-.534,.178,-.036,-.149,-.059)*f00+mat4(.2,.156,.15,-.206,.182,-.494,.296,-.48,-.442,-.453,-.608,-.283,-.351,-.149,-.117,.215)*f01+mat4(.545,.408,-.184,.306,.367,-.041,-.163,.602,.311,-.151,.754,.108,.381,-.036,.167,.889)*f02+mat4(.095,-.435,-.104,.0,-.262,-.039,.041,.106,-.052,.302,-.315,-.167,-.443,.615,.295,-.194)*f03+mat4(.375,.331,-.414,-.264,.018,-.219,.037,.38,.003,-.282,.02,.139,-.073,.057,-.075,-.279)*f04+mat4(-.151,.177,-.091,-.014,.134,.211,.067,.041,.204,.037,.029,-.245,.127,-.063,.016,-.031)*f05+vec4(-.281,-.141,.418,-.006));
    vec4 f12=sin(mat4(.154,-.352,.132,.454,.576,.162,-.282,-.382,-.257,-.034,.012,-.495,.041,-.041,.046,.586)*f00+mat4(.028,.17,-.043,.381,-.466,-.193,.064,.112,-.197,.235,.067,.341,-.554,.296,-.529,-.077)*f01+mat4(.202,.053,.31,-.52,-.266,.299,-.327,-.017,-.074,.358,.159,-.425,.507,-.165,.563,-.213)*f02+mat4(.049,.159,-.27,-.227,.5,.075,-.422,-.032,-.484,-.052,.269,-.518,.343,.368,.174,.214)*f03+mat4(.0,.071,-.521,-.194,.033,.046,-.022,-.056,.138,.046,.008,.131,.084,-.153,-.167,-.126)*f04+mat4(-.113,-.047,.075,.099,-.065,.176,.067,-.226,.159,.01,-.003,-.103,.191,.083,-.136,.015)*f05+vec4(.372,-.188,-.442,-.299));
    vec4 f13=sin(mat4(-.014,-.35,-.389,.231,-.023,-.438,.334,-.327,-.265,-.058,-.255,-.466,-.57,.387,-.023,-.168)*f00+mat4(.204,.03,-.491,.068,.219,-.14,-.082,.32,.228,-.318,.451,-.325,-.36,.22,.299,-.259)*f01+mat4(.634,.355,-.125,-.503,-.919,-.103,-.093,-.564,.133,-.714,-.351,-.061,.268,.074,.598,.54)*f02+mat4(-.097,-.3,-.021,.261,.01,-.246,.01,-.26,.431,.417,.317,.066,-.186,-.026,.144,.087)*f03+mat4(.395,-.155,-.282,.595,-.01,-.142,-.148,.188,.063,.008,-.308,-.276,-.04,-.103,-.076,.172)*f04+mat4(-.057,.182,.12,.113,-.019,-.117,.23,-.176,.063,-.13,-.271,.036,.166,.016,-.063,-.056)*f05+vec4(.431,.539,.362,.248));
    vec4 f14=sin(mat4(-.353,.266,.214,-.269,.108,-.11,-.089,-.095,.748,.337,-.145,.081,.095,-.326,.031,.224)*f00+mat4(-.214,-.273,-.061,.175,.742,.133,-.267,.041,-.027,.062,-.346,-.087,-.344,.061,.073,-.163)*f01+mat4(-.103,.258,-.554,.355,.299,-.166,-.169,.497,.374,-.675,-.179,-.237,.595,.116,-.272,.465)*f02+mat4(-.124,.291,.316,.169,-.138,.054,-.576,-.124,.261,.009,.126,.273,.297,-.071,.437,-.329)*f03+mat4(.316,-.319,-.085,.324,-.075,-.009,-.086,-.133,.175,-.002,-.239,.043,-.004,-.063,.152,.005)*f04+mat4(.07,.122,-.099,-.15,-.232,.155,.296,-.112,.105,.013,.08,-.027,.1,.084,-.086,.001)*f05+vec4(.561,.561,-.47,-.473));
    vec4 f15=sin(mat4(.46,-.184,-.234,-.3,-.414,-.155,-.101,.01,.039,-.449,-.186,-.502,.588,.366,-.379,-.226)*f00+mat4(.219,.152,.035,.248,.444,.362,.276,-.247,-.332,-.052,-.406,.653,-.074,-.209,-.005,-.448)*f01+mat4(.172,-.403,.385,-.195,-.112,.601,-.389,.514,-.486,-.311,.023,-.319,-.447,-.259,.578,.889)*f02+mat4(.134,-.192,.471,-.225,-.193,-.135,.199,-.308,.364,-.284,.032,.148,.38,-.184,-.028,.015)*f03+mat4(-.078,-.218,-.475,-.063,.133,-.102,-.109,.038,.013,.031,.168,-.037,.053,.048,.074,-.074)*f04+mat4(-.125,.169,.092,-.191,.161,.117,.022,.078,.066,.168,.077,.067,-.13,.006,-.117,.0)*f05+vec4(-.566,.519,-.033,.112));
    vec4 f16=sin(mat4(.065,-.746,.189,.298,.43,-.189,-.209,.271,.132,.692,.288,.216,-.238,-.077,.239,-.391)*f00+mat4(-.105,.219,.169,.238,.185,.176,-.032,-.314,.105,-.258,.478,-.295,-.433,-.44,-.228,.315)*f01+mat4(-.127,.363,.029,-.241,.547,-.642,.789,.441,-1.028,-.866,-.437,.596,-.392,-.752,-.974,-.213)*f02+mat4(-.469,.057,.59,-.332,.287,-.059,.004,-.276,-.435,-.326,-.443,-.094,.299,-.03,.011,-.149)*f03+mat4(.268,-.222,-.116,-.497,-.15,.027,.189,-.012,.001,-.024,.007,.073,-.049,-.238,.0,-.119)*f04+mat4(.007,-.073,.1,.147,-.349,-.007,-.294,.056,-.022,.013,-.396,-.292,-.07,-.079,-.059,.05)*f05+vec4(-.392,.445,-.096,.013));
    vec4 f17=sin(mat4(-.448,-.382,.583,.386,.353,.111,-.07,-.084,-.481,.407,.303,-.411,.325,.397,.471,-.369)*f00+mat4(-.096,.213,.073,-.019,-.046,.385,-.013,.179,.494,.074,.447,.065,-.478,.012,.098,-.317)*f01+mat4(-.627,.451,-.397,-.248,.273,.087,.423,.589,-.803,.027,.597,.31,.883,.443,.287,-.25)*f02+mat4(-.206,.226,.049,.096,-.099,.549,.091,.208,-.165,.225,.032,-.051,.141,-.346,.179,-.172)*f03+mat4(-.19,-.069,-.374,.054,-.06,.074,.06,-.114,.07,.164,.079,.095,.081,.061,-.075,-.124)*f04+mat4(-.002,.256,-.11,-.011,-.075,.158,-.057,-.089,.085,.354,.03,-.012,.079,.132,.066,.089)*f05+vec4(-.407,-.246,.207,.454));
    f00=sin(mat4(.242,-.09,-.196,-.061,-.196,-.017,-.181,.083,.306,-.463,-.576,.084,.375,-.452,-.211,.338)*f10+mat4(.213,-.221,.201,.397,-.142,.458,.132,.093,.129,-.222,.426,.114,-.547,.395,-.256,-.086)*f11+mat4(.103,.535,.297,-.421,.048,.157,-.155,.29,-.109,.053,-.171,.205,-.416,.288,-.454,.23)*f12+mat4(.428,.13,-.024,.22,.772,-.061,-.451,.363,-.091,.07,.091,-.148,-.071,.277,.424,.222)*f13+mat4(.03,.516,-.252,.14,.434,-.026,-.221,.072,.121,-.476,.104,-.351,.287,.474,-.139,-.035)*f14+mat4(.211,.289,-.044,-.364,.22,-.292,.136,.325,-.084,.561,-.436,.124,-.098,-.127,.037,.242)*f15+mat4(.446,-.433,-.299,-.277,.212,-.297,-.036,.084,.233,-.362,.252,.449,.303,-.118,.371,-.022)*f16+mat4(-.263,-.514,-.259,-.159,.379,-.262,.07,-.183,-.585,.268,.284,.548,-.154,.364,.417,-.187)*f17+vec4(.027,.468,-.018,.228));
    f01=sin(mat4(-.334,.277,.086,.235,.093,.23,.063,-.263,-.19,-.01,.28,.072,-.013,-.497,-.186,.295)*f10+mat4(.138,.376,.308,.161,-.002,.304,.133,.038,.175,.242,-.196,.068,.563,.156,.05,-.167)*f11+mat4(.294,.334,.41,.526,.245,.305,.173,.07,.722,.425,-.317,-.186,-.056,.112,-.055,-.356)*f12+mat4(.182,-.652,-.305,-.152,-.648,-.339,-.013,.165,-.288,.122,.139,.126,-.373,.355,.2,.083)*f13+mat4(.371,.385,.076,-.091,.208,-.26,-.493,-.057,-.019,.082,-.248,.296,.275,-.007,.111,.006)*f14+mat4(.345,.269,.019,.475,-.305,-.376,-.098,.424,-.074,-.005,.107,-.04,-.075,-.302,-.19,-.152)*f15+mat4(-.332,-.307,-.112,.059,-.459,.28,.268,.277,.249,-.6,-.278,-.221,-.562,.222,.059,.124)*f16+mat4(.207,-.437,-.042,-.018,-.2,.111,-.353,.007,-.248,-.375,-.047,.183,-.475,.397,-.592,.129)*f17+vec4(-.362,.03,-.154,-.366));
    f02=sin(mat4(-.494,.118,.223,-.009,.151,-.027,-.178,-.22,-.198,-.148,.283,-.325,.489,.302,-.192,.396)*f10+mat4(-.317,.095,.126,-.255,-.181,-.229,.187,-.364,.193,.276,.22,.183,-.501,.02,.179,-.399)*f11+mat4(-.267,-.44,.132,-.361,.165,.295,-.636,.285,.106,-.538,-.219,.033,.471,.377,.517,.155)*f12+mat4(-.151,-.38,-.108,.148,-.282,.352,.065,.053,.27,-.305,.461,-.211,.5,-.399,.463,-.176)*f13+mat4(-.014,-.471,.21,.004,-.145,.15,.454,.512,-.652,.305,-.386,.205,.004,-.052,-.029,-.012)*f14+mat4(-.162,.386,.397,.219,-.323,.317,.063,.437,-.148,-.208,.04,-.226,.063,-.045,-.248,-.309)*f15+mat4(-.366,.523,-.079,.115,-.031,.236,.241,-.287,.267,.481,-.482,-.253,-.128,-.359,-.03,.362)*f16+mat4(.276,.146,-.168,-.135,.235,.284,.006,-.106,.077,-.095,-.066,.245,.313,.516,-.248,-.03)*f17+vec4(.097,-.312,.03,-.279));
    f03=sin(mat4(-.05,-.022,-.575,-.127,.253,.108,.208,.122,.116,.185,.238,.196,-.171,-.387,.412,-.045)*f10+mat4(.111,-.14,-.114,-.566,-.001,.106,-.401,.262,-.119,.353,.208,-.253,-.077,.059,.326,.256)*f11+mat4(-.04,-.157,.358,-.361,-.287,-.33,.158,.761,-.441,.237,.352,-.067,-.329,-.199,-.303,-.46)*f12+mat4(-.47,.205,.088,.292,-.278,-.114,.583,-.306,-.093,-.514,-.717,.111,.16,.305,.405,-.434)*f13+mat4(-.325,.222,.229,.075,-.316,-.069,.089,-.362,-.343,.323,.54,.421,-.482,-.095,-.177,-.013)*f14+mat4(.055,.111,-.621,.251,-.152,.082,-.224,-.195,.364,-.128,.222,.048,.152,.291,.056,.173)*f15+mat4(.038,-.146,.223,.376,-.147,.222,.514,.467,-.368,-.12,-.45,.751,.306,.097,-.437,-.317)*f16+mat4(.336,-.422,.071,.574,.16,-.298,-.644,.125,.434,.089,.093,.104,.041,-.271,-.523,.29)*f17+vec4(.302,.018,.084,.1));
    f04=sin(mat4(-.18,.345,.021,-.01,-.04,-.266,.165,.245,-.359,.288,.511,.465,.46,.039,-.108,-.578)*f10+mat4(-.152,.23,-.194,.389,-.429,.111,-.418,.23,.235,-.351,-.072,-.501,-.174,.174,-.141,.318)*f11+mat4(-.472,-.308,-.287,-.728,.228,-.416,.51,.143,.101,-.217,.186,.029,.26,-.082,-.091,-.551)*f12+mat4(.497,-.293,-.413,-.441,-.065,-.158,.263,.112,.265,-.31,-.266,.266,-.15,.023,-.15,-.131)*f13+mat4(-.102,.332,-.101,.54,.054,.176,-.309,.348,.353,-.149,.121,.338,-.194,.035,-.188,-.177)*f14+mat4(-.656,-.26,.263,.501,-.493,.255,.083,-.009,.145,-.288,-.159,-.305,-.335,-.326,.043,-.321)*f15+mat4(-.004,.033,-.257,-.467,-.012,-.078,.068,-.064,-.669,-.042,.119,.185,.269,-.082,.0,.258)*f16+mat4(-.365,.139,.026,.108,-.176,.112,-.193,-.186,.201,-.29,-.443,.364,.096,.086,.11,.24)*f17+vec4(.266,.069,.412,-.029));
    f05=sin(mat4(-.001,.259,.235,-.382,.057,-.405,-.186,.358,-.178,-.334,-.275,.158,-.048,.058,-.143,-.17)*f10+mat4(.311,-.097,.158,.3,.054,.23,.229,-.337,-.497,.051,.192,.047,-.238,-.02,.064,.168)*f11+mat4(.235,-.327,.226,.003,.38,.329,.29,-.149,.342,-.463,.286,.661,.26,-.181,.137,-.093)*f12+mat4(-.05,-.154,.092,.022,.267,-.224,.193,.217,.139,-.266,.309,-.196,.483,-.389,.4,-.208)*f13+mat4(.204,-.079,-.325,.194,.372,-.228,-.478,-.187,-.284,.236,-.156,.334,-.364,-.348,.269,.234)*f14+mat4(.212,.012,-.239,-.191,-.171,.133,.486,.107,.004,.251,.177,.019,.178,-.258,.056,-.421)*f15+mat4(.259,.14,.099,-.014,-.204,.217,.02,-.063,.038,.486,.141,.205,-.1,.05,.184,.008)*f16+mat4(.494,.135,.1,-.254,-.208,.009,.56,-.361,-.025,-.323,-.173,-.403,.091,.345,-.073,.275)*f17+vec4(.404,.113,-.2,-.38));
    vec4 f06=sin(mat4(.197,.022,.066,-.032,-.157,.428,.296,.504,-.166,-.52,-.118,-.146,.556,.008,.067,-.067)*f10+mat4(.214,-.316,.032,-.342,-.599,-.05,.061,.028,-.221,-.306,-.09,.143,-.532,.271,.313,.006)*f11+mat4(.09,.348,.125,-.066,-.42,-.176,.047,.288,-.238,-.023,-.195,.255,.194,-.33,-.054,.156)*f12+mat4(.178,-.413,.045,.321,.168,-.147,.249,-.21,.221,-.166,.303,-.212,-.436,-.199,-.1,.159)*f13+mat4(-.203,-.139,-.118,.262,.169,-.203,-.178,-.14,.317,.311,-.011,-.031,.024,.142,-.367,-.377)*f14+mat4(-.099,.17,.238,.23,.06,-.179,.037,-.391,.591,.245,.025,.001,.198,.104,-.116,-.092)*f15+mat4(.216,-.386,-.414,.27,-.032,-.049,.201,.476,-.362,-.255,-.171,-.04,.145,-.253,.06,-.144)*f16+mat4(-.166,.08,-.098,.09,.056,.197,-.626,-.364,-.127,.069,-.36,.374,-.005,-.404,.483,-.499)*f17+vec4(-.102,.251,-.277,-.344));
    vec4 f07=sin(mat4(.367,-.25,.267,.111,.101,.066,-.29,.29,.351,-.71,-.025,-.176,-.194,.077,.105,-.198)*f10+mat4(-.181,-.107,.233,.019,-.213,.168,.02,.26,.323,.083,-.078,.17,-.204,.062,-.588,.076)*f11+mat4(-.104,-.102,.228,.045,-.136,.445,-.338,-.475,.172,.281,-.204,-.164,.293,-.087,-.238,-.304)*f12+mat4(.233,.047,.198,-.038,.273,-.34,-.064,-.275,.185,-.041,.301,.192,.176,-.124,.102,-.219)*f13+mat4(.333,.071,-.464,.036,.183,-.485,.017,.37,-.264,-.416,-.209,-.475,-.798,.253,-.165,.269)*f14+mat4(-.109,-.129,-.117,-.136,-.026,.237,.482,.382,-.423,.315,-.068,-.364,-.145,.54,-.222,.365)*f15+mat4(-.099,-.244,-.221,.168,.427,-.171,-.132,-.055,-.016,-.158,.322,.292,-.428,.308,.516,-.397)*f16+mat4(-.098,-.456,-.326,.107,-.129,-.387,-.047,.383,-.628,-.381,.222,.305,-.368,.063,-.279,.368)*f17+vec4(.036,-.322,-.269,.517));
    f10=sin(mat4(.424,.479,-.11,-.138,-.273,.521,.311,.604,-.357,.428,.013,.266,-.273,.448,-.417,.061)*f00+mat4(.403,-.874,.095,-.237,-.242,-.48,.3,.29,-.579,-.45,-.265,.504,.026,.22,.429,.333)*f01+mat4(.089,-.873,.099,.064,-.33,.814,.417,-.118,-.153,-.057,.165,.22,-.155,.361,.316,-.413)*f02+mat4(-.369,-.134,-.344,-.244,-.106,-.334,.094,.494,-.052,.318,.202,.15,-.248,-.304,.24,-.313)*f03+mat4(.36,.582,.288,.191,.081,.144,.106,.29,-.023,-.025,.209,.009,-.177,-.737,-.186,.027)*f04+mat4(-.106,.031,-.351,.369,.146,-.686,-.016,-.463,.131,.137,.546,.252,-.483,-.036,-.075,.161)*f05+mat4(.281,.322,.055,.062,-.01,-.381,.261,.353,-.805,.488,.3,-.26,.51,-.218,-.106,-.388)*f06+mat4(-.219,.444,.002,-.334,.544,-.173,.28,.087,-.082,.67,-.056,-.439,.309,-.459,-.086,-.035)*f07+vec4(.214,.331,-.214,-.207));
    f11=sin(mat4(-.404,.28,.005,.022,-.243,-.119,.225,.13,.105,-.553,.281,.233,.313,-.046,-.084,.03)*f00+mat4(.476,-.27,-.422,-.015,.21,-.171,-.152,.35,-.427,-.003,-.137,.101,.126,.355,-.198,.067)*f01+mat4(.327,-.14,-.384,-.078,-.319,.2,.096,.53,.535,-.149,.199,.408,.004,-.345,.143,.33)*f02+mat4(.03,.024,-.004,.15,.223,-.245,.439,-.022,-.627,.192,.252,.246,-.191,-.282,-.345,-.327)*f03+mat4(-.141,-.075,-.108,-.082,.029,.173,.04,.433,-.431,.273,-.075,.495,.044,-.077,.084,-.536)*f04+mat4(.215,-.44,.078,.306,-.211,-.163,.376,-.362,.146,-.243,-.062,.0,-.023,.273,.088,.226)*f05+mat4(-.365,.161,.571,.546,-.266,.229,.2,.0,-.025,-.03,.216,.263,-.162,.159,-.054,-.347)*f06+mat4(-.301,.027,-.198,.04,.208,-.266,-.339,-.548,-.014,-.096,.266,-.012,-.358,.045,-.175,-.209)*f07+vec4(-.458,.287,.301,.036));
    f12=sin(mat4(-.484,-.241,.309,-.043,.161,.287,-.454,.264,.372,-.482,-.121,.315,.41,-.165,-.123,-.074)*f00+mat4(.15,-.428,-.015,-.157,.096,.188,.6,.211,-.311,-.26,.539,-.06,-.329,.028,.065,-.151)*f01+mat4(-.028,.283,.525,-.602,-.047,.152,-.232,.67,-.03,.046,.242,.5,-.468,-.135,-.509,.264)*f02+mat4(.019,-.22,.502,-.16,-.304,-.267,-.118,-.249,-.239,.363,-.125,.252,-.102,.113,.312,-.416)*f03+mat4(-.122,-.394,.314,.147,-.529,-.52,-.599,.168,-.382,.324,-.18,-.615,.207,-.101,.209,-.408)*f04+mat4(.71,.063,.002,-.017,.264,-.01,-.272,-.182,-.008,-.337,.217,-.096,.303,-.347,.366,.346)*f05+mat4(.339,.588,-.588,-.129,-.122,-.068,.088,.233,-.354,.119,-.064,.238,-.054,.33,.221,-.076)*f06+mat4(.056,.366,.06,.466,-.004,.151,.371,-.07,-.186,.412,-.109,.252,-.022,.134,-.086,-.695)*f07+vec4(-.047,-.252,-.301,-.131));
    f13=sin(mat4(-.391,-.009,-.408,.054,.245,-.019,-.676,.142,.118,.396,.048,.166,-.117,.07,-.139,.424)*f00+mat4(-.255,.232,.724,-.204,-.189,.117,.465,-.3,.145,-.357,.107,.612,.292,.498,-.207,.048)*f01+mat4(-.673,.17,.348,-.467,.442,.182,-.521,.133,.83,-.185,-.517,.429,.485,-.23,-.35,.168)*f02+mat4(.256,-.239,.089,.266,.348,.048,-.02,-.503,.102,.099,-.51,.101,-.321,.201,.266,-.037)*f03+mat4(-.04,.242,-.005,.108,.172,.075,-.42,.002,.381,-.402,-.303,.715,-.089,.131,.37,-.126)*f04+mat4(.026,-.095,-.364,.241,.187,.174,.42,-.307,.01,-.087,.148,-.603,-.001,.116,.398,-.637)*f05+mat4(.344,-.396,-.151,.059,-.516,.341,.49,-.422,-.03,-.246,.026,.032,-.389,-.11,.551,-.281)*f06+mat4(.171,-.238,-.293,.201,-.368,-.462,.608,-.53,.468,.243,.047,.046,-.455,.328,.509,-.503)*f07+vec4(-.219,.025,-.041,-.009));
    f14=sin(mat4(-.216,.359,.112,-.16,.533,.11,.241,.031,.586,-.061,.251,-.019,.386,-.548,-.207,.296)*f00+mat4(-.284,-.17,.024,-.36,.22,-.268,.03,.381,-.269,.202,.304,.158,-.488,.403,.129,.153)*f01+mat4(-.169,.029,.066,-.419,.337,.219,-.022,-.187,.167,-.32,.153,.063,.271,.301,.033,-.015)*f02+mat4(.395,-.225,.125,-.18,-.344,-.044,-.258,.714,-.002,-.041,.087,.016,.152,-.137,.359,-.578)*f03+mat4(.499,.473,-.06,-.101,-.298,-.276,-.35,-.169,-.179,-.58,.298,-.124,-.08,-.317,-.029,-.051)*f04+mat4(-.403,-.427,.435,.689,-.183,-.116,.475,.166,.04,.164,-.313,-.372,.218,-.349,-.281,.138)*f05+mat4(-.545,-.156,-.165,.046,.293,.192,.576,-.322,.458,.037,-.152,.121,-.007,.174,.037,-.093)*f06+mat4(.263,.243,-.127,-.191,.099,-.177,-.149,-.463,-.085,-.267,.208,-.433,-.159,.112,.317,-.044)*f07+vec4(.054,-.382,-.004,.332));
    f15=sin(mat4(.147,.351,-.285,.318,.251,-.045,-.031,.238,.051,-.296,-.14,.155,.051,-.316,-.032,.043)*f00+mat4(-.233,.301,.344,.241,-.562,.042,.094,-.296,.158,.307,.021,.195,.413,-.275,.207,.066)*f01+mat4(-.409,.157,.235,.496,.441,.086,-.059,-.163,-.048,-.027,-.029,-.342,.056,.531,-.186,-.153)*f02+mat4(-.149,-.182,.463,-.377,.191,-.254,-.015,.015,.089,.339,-.235,.013,.258,-.231,.054,.026)*f03+mat4(.263,.105,-.08,.123,-.63,.243,-.265,-.174,-.161,-.496,-.155,.269,-.177,-.305,.369,.214)*f04+mat4(.005,-.214,.302,.309,-.003,-.309,.156,-.149,-.005,.201,-.284,.047,-.085,.262,.145,.241)*f05+mat4(.148,.088,.37,-.303,-.162,.115,-.174,.167,-.098,-.315,.347,-.349,-.078,-.119,.026,-.144)*f06+mat4(.186,.305,-.03,.041,.462,-.165,.006,-.074,.16,.292,-.417,-.216,-.361,.003,.007,.281)*f07+vec4(-.087,-.281,.511,-.027));
    f16=sin(mat4(.014,.157,.17,.455,.274,.193,-.201,.341,-.287,-.279,.372,.002,.165,.143,-.331,.168)*f00+mat4(-.122,.479,-.244,-.082,-.496,.576,-.297,-.321,-.016,.049,.31,.644,-.056,-.31,.333,-.255)*f01+mat4(.308,.092,-.157,-.589,-.016,.046,.233,.197,-.156,.189,-.371,.136,-.03,-.763,.069,-.168)*f02+mat4(.655,-.638,-.061,-.007,-.005,.409,-.425,-.324,-.116,-.039,-.08,.344,-.12,.185,.305,-.508)*f03+mat4(.206,-.181,.386,.116,-.304,-.352,.194,-.403,.133,-.601,.067,.18,.155,.069,-.099,-.239)*f04+mat4(.136,-.129,-.084,-.226,-.313,-.176,-.139,-.256,.103,.626,.438,.088,-.626,.112,.02,.092)*f05+mat4(.18,.346,.02,.115,.099,.513,.057,-.138,.012,-.231,-.236,.391,-.104,.526,-.023,.224)*f06+mat4(-.274,-.309,.3,.262,-.032,-.044,-.049,.057,.513,-.565,-.311,.373,.347,-.009,.112,.168)*f07+vec4(.384,-.416,.308,-.023));
    f17=sin(mat4(-.24,-.218,.231,.13,.139,.171,-.597,.35,-.276,.057,-.184,.153,-.401,.139,-.162,.393)*f00+mat4(-.411,-.224,.064,-.28,.097,.201,-.172,-.506,-.344,.034,-.15,.11,-.139,-.241,-.339,.426)*f01+mat4(-.389,-.318,.607,-.206,.043,.318,-.036,.142,.046,.191,-.057,.138,.052,-.079,-.432,.39)*f02+mat4(.142,.382,-.218,-.169,.482,-.358,.14,-.363,-.102,-.44,.351,-.141,-.409,.016,.084,-.336)*f03+mat4(-.174,-.22,.008,.179,.164,-.334,-.117,.032,-.036,-.551,-.545,.199,-.34,.19,.324,.104)*f04+mat4(.451,.37,.363,-.228,-.167,-.131,-.238,.428,.177,-.219,-.053,.24,.394,.338,-.516,-.133)*f05+mat4(-.099,-.236,.073,.062,.062,-.092,.07,-.098,.557,-.133,-.289,.068,.417,.185,.308,.27)*f06+mat4(.096,-.395,.009,.177,.276,-.04,.551,.291,.197,-.015,-.095,-.183,-.406,.476,.135,-.091)*f07+vec4(-.442,.293,.476,-.445));
    vec4 outc=f10*mat4(-.129,-.982,-.544,.135,.461,-.334,-.624,.502,.277,-.229,-.324,.239,.0,.0,.0,.0)+f11*mat4(.274,.265,-.487,-.62,-.306,-.103,.475,.115,-.264,-.309,.077,.153,.0,.0,.0,.0)+f12*mat4(-.436,-.2,.371,-.667,.237,-.566,.384,-.203,-.034,-.205,.091,-.017,.0,.0,.0,.0)+f13*mat4(-.22,.102,.522,-.501,-.128,-.096,.684,.094,.155,.497,.383,-.055,.0,.0,.0,.0)+f14*mat4(-.504,-.241,.479,-.16,-.233,-.518,.312,-.189,.027,-.023,-.087,.321,.0,.0,.0,.0)+f15*mat4(-.938,-.586,.513,.532,.002,-.537,.442,-.233,-.094,-.432,.742,-.348,.0,.0,.0,.0)+f16*mat4(.151,.221,-.265,.121,.384,.517,-.486,-.522,-.09,.27,-.417,-.276,.0,.0,.0,.0)+f17*mat4(-.003,.492,.374,-.552,.182,.209,.244,-.291,.402,.062,.185,-.255,.0,.0,.0,.0)+vec4(.401,-.218,.006,.0);
    vec3 color = vec3(1.) / ( vec3(1.) + pow(vec3(2.71828), -outc.xyz));//sigmoid
    gl_FragColor.rgba = vec4(color.xyz, 1.0);
}
```

## Train
```
python train.py > log.log 2>&1 &
tensorboard --logdir=/root/tf-logs
```